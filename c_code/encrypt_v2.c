// #include <cstddef>
#include <stdio.h>
#include <stdlib.h>

void xor_encrypt(char *data, size_t data_len, char *key, size_t key_len) {
    for (size_t i = 0; i < data_len; i++) {
        data[i] ^= key[i % key_len];
    }
    // rand();
}

void generate_key(char* key, size_t length) {
    /* Define the characters that we want in the key */
    char characters[] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()__+";

    /* Open /dev/urandom for reading */
    FILE* urandom = fopen("/dev/urandom", "r");
    if (urandom == NULL) {
        fprintf(stderr, "Failed to open /dev/urandom\n");
        exit(1);
    }

    /* Generate the key */
    for (size_t i = 0; i < length; i++) {
        unsigned char random_value;
        fread(&random_value, sizeof(random_value), 1, urandom);
        key[i] = characters[random_value % (sizeof(characters) - 1)];
    }

    /* Null-terminate the string */
    key[length] = '\0';

    /* Close /dev/urandom */
    fclose(urandom);
}

/* Usage */
int main() {
	char key[17];
	generate_key(key,17);
	
	printf("%s\n",key);

    return 0;
}